const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/GameTable-DxNRlwh8.js","assets/react-vendor-RsqJS7wA.js","assets/howler-vendor-CbBpPY6X.js","assets/game-utils-CVViNcXd.js","assets/GameTable-JJXt5KYL.css","assets/game-components-B4eLmyb7.js","assets/game-components-ldK6loKu.css"])))=>i.map(i=>d[i]);
import{r as e,g as a}from"./react-vendor-RsqJS7wA.js";import{r as s}from"./howler-vendor-CbBpPY6X.js";import{a as n,c as t}from"./game-utils-CVViNcXd.js";var r,o,i={exports:{}},l={};var c=(o||(o=1,i.exports=function(){if(r)return l;r=1;var e=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(a,s,n){var t=null;if(void 0!==n&&(t=""+n),void 0!==s.key&&(t=""+s.key),"key"in s)for(var r in n={},s)"key"!==r&&(n[r]=s[r]);else n=s;return s=n.ref,{$$typeof:e,type:a,key:t,ref:void 0!==s?s:null,props:n}}return l.Fragment=a,l.jsx=s,l.jsxs=s,l}()),i.exports),d=e();const u=a(d);var h=s();
/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m=e=>{const a=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,a,s)=>s?s.toUpperCase():a.toLowerCase()))(e);return a.charAt(0).toUpperCase()+a.slice(1)},y=(...e)=>e.filter((e,a,s)=>Boolean(e)&&""!==e.trim()&&s.indexOf(e)===a).join(" ").trim(),p=e=>{for(const a in e)if(a.startsWith("aria-")||"role"===a||"title"===a)return!0};
/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var j={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x=d.forwardRef(({color:e="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:t="",children:r,iconNode:o,...i},l)=>d.createElement("svg",{ref:l,...j,width:a,height:a,stroke:e,strokeWidth:n?24*Number(s)/Number(a):s,className:y("lucide",t),...!r&&!p(i)&&{"aria-hidden":"true"},...i},[...o.map(([e,a])=>d.createElement(e,a)),...Array.isArray(r)?r:[r]])),b=(e,a)=>{const s=d.forwardRef(({className:s,...n},t)=>{return d.createElement(x,{ref:t,iconNode:a,className:y(`lucide-${r=m(e),r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,s),...n});var r});return s.displayName=m(e),s},w=b("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),g=b("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),v=b("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),f=b("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]),k=b("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),N=b("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),C=b("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),S=b("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),P=b("volume-x",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),T={},E=function(e,a,s){let n=Promise.resolve();if(a&&a.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),t=s?.nonce||s?.getAttribute("nonce");n=e(a.map(e=>{if((e=function(e){return"/"+e}(e))in T)return;T[e]=!0;const a=e.endsWith(".css"),s=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const n=document.createElement("link");return n.rel=a?"stylesheet":"modulepreload",a||(n.as="script"),n.crossOrigin="",n.href=e,t&&n.setAttribute("nonce",t),document.head.appendChild(n),a?new Promise((a,s)=>{n.addEventListener("load",a),n.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function t(e){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=e,window.dispatchEvent(a),!a.defaultPrevented)throw e}return n.then(a=>{for(const e of a||[])"rejected"===e.status&&t(e.reason);return e().catch(t)})},L=({isVisible:e,message:a="Loading...",showSpinner:s=!0})=>(d.useEffect(()=>{if(e)return n(a,"polite"),document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}},[e,a]),e?c.jsx("div",{className:"loading-overlay",role:"status","aria-live":"polite","aria-label":a,children:c.jsxs("div",{className:"loading-content",children:[s&&c.jsxs("div",{className:"loading-spinner","aria-hidden":"true",children:[c.jsx("div",{className:"spinner-ring"}),c.jsx("div",{className:"spinner-ring"}),c.jsx("div",{className:"spinner-ring"})]}),c.jsx("p",{className:"loading-message",children:a})]})}):null);
/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function O(e,a="Loading..."){const s=d.lazy(e);return function(e){return c.jsx(d.Suspense,{fallback:c.jsx(L,{isVisible:!0,message:a,showSpinner:!0}),children:c.jsx(s,{...e})})}}const $=O(()=>E(()=>import("./GameTable-DxNRlwh8.js"),__vite__mapDeps([0,1,2,3,4])),"Loading game table..."),M=O(()=>E(()=>import("./game-components-B4eLmyb7.js").then(e=>e.G),__vite__mapDeps([5,6])),"Loading game results..."),_=O(()=>E(()=>import("./game-components-B4eLmyb7.js").then(e=>e.T),__vite__mapDeps([5,6])),"Loading tutorial..."),A=({isOpen:e,onClose:a,title:s,showCloseButton:r=!0,closeButtonText:o="Close",closeOnOverlayClick:i=!0,closeOnEscape:l=!0,className:u="",contentClassName:h="",focusTrapOptions:m={},children:y,announceOnOpen:p=!0,announcementMessage:j})=>{const x=d.useRef(null),b=d.useRef(null);d.useEffect(()=>{if(e&&x.current&&(b.current=t(x.current,{restoreFocus:!0,...m}),b.current.activate(),p)){n(j||`${s} dialog opened`,"polite")}return()=>{b.current&&(b.current.deactivate(),b.current=null)}},[e,s,p,j,m]);const w=d.useCallback(s=>{e&&l&&"Escape"===s.key&&(s.preventDefault(),a())},[e,l,a]);d.useEffect(()=>{if(e)return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[e,w]);const g=d.useCallback(e=>{i&&e.target===e.currentTarget&&a()},[i,a]),v=d.useCallback(()=>{a()},[a]);return e?c.jsx("div",{className:`modal-overlay ${u}`,onClick:g,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",ref:x,children:c.jsxs("div",{className:`modal-content ${h}`,children:[c.jsxs("div",{className:"modal-header",children:[c.jsx("h2",{id:"modal-title",className:"modal-title",children:s}),r&&c.jsxs("button",{type:"button",className:"modal-close-button",onClick:v,"aria-label":`Close ${s} dialog`,children:[c.jsx("span",{"aria-hidden":"true",children:"Ã—"}),c.jsx("span",{className:"sr-only",children:o})]})]}),c.jsx("div",{className:"modal-body",children:y})]})}):null},R=({isOpen:e,onClose:a,title:s="Error",message:n,showRetryButton:t=!1,onRetry:r,retryButtonText:o="Retry"})=>c.jsxs(A,{isOpen:e,onClose:a,title:s,closeButtonText:"OK",className:"error-modal",contentClassName:"error-content",announceOnOpen:!0,announcementMessage:`${s}: ${n}`,children:[c.jsxs("div",{className:"error-message",children:[c.jsx("div",{className:"error-icon","aria-hidden":"true",children:"âš ï¸"}),c.jsx("p",{children:n})]}),c.jsxs("div",{className:"error-actions",children:[t&&r&&c.jsx("button",{className:"error-retry-button",onClick:()=>{r&&r(),a()},autoFocus:!0,children:o}),c.jsx("button",{className:"error-close-button",onClick:a,autoFocus:!t,children:"OK"})]})]}),F="https://njuka-webapp-backend.onrender.com",z=({onSelectMode:e,playerName:a,setPlayerName:s})=>c.jsxs("div",{className:"page-container",children:[c.jsxs("div",{className:"welcome-section",children:[c.jsx("h2",{children:"Welcome to Njuka King!"}),c.jsx("p",{children:"Choose your game mode to start playing"})]}),c.jsxs("div",{className:"new-game-form",children:[c.jsxs("label",{children:["Your Name:",c.jsx("input",{type:"text",value:a,onChange:e=>{const a=e.target.value.trim();a.length<=20&&s(a)},placeholder:"Enter your name (2-20 chars)",minLength:2,maxLength:20,required:!0})]}),c.jsxs("div",{className:"game-mode-buttons",children:[c.jsxs("button",{className:"mode-button multiplayer-button",onClick:()=>e("multiplayer"),disabled:!a.trim(),children:[c.jsx(C,{size:32}),c.jsx("span",{children:"Multiplayer"}),c.jsx("p",{children:"Play with friends online"})]}),c.jsxs("button",{className:"mode-button cpu-button",onClick:()=>e("cpu"),disabled:!a.trim(),children:[c.jsx(v,{size:32}),c.jsx("span",{children:"VS CPU"}),c.jsx("p",{children:"Play against computer opponents"})]})]})]})]}),B=({onBack:e,playerName:a,numPlayers:s,setNumPlayers:n,onCreateLobby:t,onJoinLobby:r,lobbies:o,loadingStates:i,onRefreshLobbies:l})=>c.jsxs("div",{className:"page-container",children:[c.jsxs("div",{className:"page-header",children:[c.jsxs("button",{onClick:e,className:"back-button",children:[c.jsx(w,{size:20}),"Back"]}),c.jsx("h2",{children:"Multiplayer Lobby"})]}),c.jsxs("div",{className:"multiplayer-content",children:[c.jsxs("div",{className:"create-lobby-section",children:[c.jsx("h3",{children:"Create New Game"}),c.jsxs("label",{children:["Max Players:",c.jsxs("select",{value:s,onChange:e=>n(Number(e.target.value)),children:[c.jsx("option",{value:2,children:"2 Players"}),c.jsx("option",{value:3,children:"3 Players"}),c.jsx("option",{value:4,children:"4 Players"}),c.jsx("option",{value:5,children:"5 Players"}),c.jsx("option",{value:6,children:"6 Players"})]})]}),c.jsx("button",{onClick:t,disabled:i.starting||!a.trim(),className:"create-lobby-btn",children:i.starting?"Creating...":"Create New Game"})]}),c.jsx("div",{className:"divider",children:c.jsx("span",{children:"OR"})}),c.jsxs("div",{className:"join-lobby-section",children:[c.jsxs("div",{className:"lobby-header",children:[c.jsx("h3",{children:"Available Lobbies"}),c.jsx("button",{onClick:l,className:"refresh-btn",children:"Refresh"})]}),c.jsx("div",{className:"lobby-list",children:0===o.length?c.jsxs("div",{className:"no-lobbies",children:[c.jsx("p",{children:"No games available right now."}),c.jsx("p",{children:"Create a new game to start playing!"})]}):o.map(e=>c.jsxs("div",{className:"lobby-item",children:[c.jsxs("div",{className:"lobby-info",children:[c.jsxs("h4",{children:["Host: ",e.host]}),c.jsxs("p",{children:["Players: ",e.players.length,"/",e.max_players]}),c.jsx("div",{className:"player-list-preview",children:e.players.map(a=>c.jsxs("span",{className:"player-tag",children:[a,a===e.host&&" ðŸ‘‘"]},a))}),c.jsxs("p",{className:"lobby-created",children:["Created: ",new Date(e.created_at).toLocaleString()]})]}),c.jsx("button",{onClick:()=>r(e.id),disabled:e.players.length>=e.max_players||i.joining,className:"join-lobby-btn",children:i.joining?"Joining...":"Join Game"})]},e.id))})]})]})]}),G=({onBack:e,onStartGame:a,numCPU:s,setNumCPU:n,loadingStates:t})=>c.jsxs("div",{className:"page-container",children:[c.jsxs("div",{className:"page-header",children:[c.jsxs("button",{onClick:e,className:"back-button",children:[c.jsx(w,{size:20}),"Back"]}),c.jsx("h2",{children:"Play vs CPU"})]}),c.jsx("div",{className:"cpu-game-content",children:c.jsxs("div",{className:"cpu-options",children:[c.jsx("h3",{children:"Choose Your Opponents"}),c.jsx("p",{children:"Select how many CPU players you want to face"}),c.jsxs("div",{className:"cpu-selection",children:[c.jsx("label",{children:"Number of CPU Players:"}),c.jsx("div",{className:"cpu-buttons",children:[1,2,3].map(e=>c.jsxs("button",{onClick:()=>n(e),className:"cpu-count-btn "+(s===e?"selected":""),children:[e," CPU"]},e))})]}),c.jsxs("div",{className:"difficulty-info",children:[c.jsx("h4",{children:"CPU Difficulty: Smart"}),c.jsx("p",{children:"CPU players will make strategic decisions and try to win!"})]}),c.jsx("button",{onClick:a,disabled:t.starting,className:"start-cpu-game-btn",children:t.starting?"Starting Game...":`Start Game vs ${s} CPU`})]})})]}),H=({onBack:e})=>c.jsxs("div",{className:"page-container",children:[c.jsxs("div",{className:"page-header",children:[c.jsxs("button",{onClick:e,className:"back-button",children:[c.jsx(w,{size:20}),"Back"]}),c.jsx("h2",{children:"How to Play Njuka King"})]}),c.jsxs("div",{className:"rules-content",children:[c.jsxs("section",{className:"rules-section",children:[c.jsx("h3",{children:"ðŸŽ¯ Objective"}),c.jsx("p",{children:"Be the first player to create a winning hand of exactly 4 cards."})]}),c.jsxs("section",{className:"rules-section",children:[c.jsx("h3",{children:"ðŸƒ Winning Hand"}),c.jsx("p",{children:"A winning hand consists of:"}),c.jsxs("ul",{children:[c.jsxs("li",{children:[c.jsx("strong",{children:"One Pair"})," - Two cards of the same rank (e.g., two 8s)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Two Followers"})," - Two cards in sequential order (e.g., 9 and 10)"]})]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Example:"})," 8â™¥, 8â™ , 9â™£, 10â™¦ (pair of 8s + 9,10 sequence)"]})]}),c.jsxs("section",{className:"rules-section",children:[c.jsx("h3",{children:"ðŸŽ® How to Play"}),c.jsxs("ol",{children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Draw Phase:"})," On your turn, draw one card from the deck"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Discard Phase:"})," Choose one card from your hand to discard"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Win Check:"})," If you have a winning hand, the game ends and you win!"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Continue:"})," Play passes to the next player"]})]})]})]})]}),q=({quitGameToMenu:e,soundsEnabled:a,toggleSounds:s,playSound:n,onShowRules:t,onGoHome:r})=>{const[o,i]=d.useState(!1),[l,u]=d.useState(!1),h=e=>{n("button"),navigator.vibrate&&navigator.vibrate([40,20,40]),e()},m=()=>{i(!o),u(!1)},y=()=>{u(!l),i(!1)};return c.jsxs("div",{className:"enhanced-bottom-menu",children:[o&&c.jsx("div",{className:"expanded-panel settings-panel",children:c.jsxs("button",{onClick:()=>h(s),className:"panel-button",children:[a?c.jsx(S,{size:20}):c.jsx(P,{size:20}),"Sound ",a?"ON":"OFF"]})}),l&&c.jsx("div",{className:"expanded-panel info-panel",children:c.jsxs("button",{onClick:()=>h(t),className:"panel-button",children:[c.jsx(g,{size:20}),"Rules"]})}),c.jsxs("div",{className:"main-menu-bar",children:[c.jsxs("button",{onClick:()=>h(r),className:"menu-button",children:[c.jsx(f,{size:20}),c.jsx("span",{children:"Home"})]}),c.jsxs("button",{onClick:()=>h(m),className:"menu-button "+(o?"active":""),children:[c.jsx(N,{size:20}),c.jsx("span",{children:"Settings"})]}),c.jsxs("button",{onClick:()=>h(y),className:"menu-button "+(l?"active":""),children:[c.jsx(k,{size:20}),c.jsx("span",{children:"Info"})]}),e&&c.jsx("button",{onClick:()=>h(e),className:"menu-button quit-button",children:c.jsx("span",{children:"Quit"})})]})]})};function U(){const[e,a]=d.useState("home"),[s,n]=d.useState(""),[t,r]=d.useState(2),[o,i]=d.useState(1),[l,u]=d.useState([]),[m,y]=d.useState(null),[p,j]=d.useState(null),[x,b]=d.useState(null),[w,g]=d.useState({starting:!1,joining:!1,drawing:!1,discarding:!1,cpuMoving:!1}),{playSound:v,soundsEnabled:f,toggleSounds:k}=(()=>{const[e,a]=d.useState(!0),[s,n]=d.useState(null),t=d.useCallback(async(e,a,t="sine")=>{if("undefined"!=typeof window&&(window.AudioContext||window.webkitAudioContext))try{let r=s;r||(r=new(window.AudioContext||window.webkitAudioContext),n(r)),"suspended"===r.state&&await r.resume();const o=r.createOscillator(),i=r.createGain();o.connect(i),i.connect(r.destination),o.frequency.setValueAtTime(e,r.currentTime),o.type=t,i.gain.setValueAtTime(.05,r.currentTime),i.gain.exponentialRampToValueAtTime(.001,r.currentTime+a),o.start(r.currentTime),o.stop(r.currentTime+a)}catch(x){}},[s]),r=d.useMemo(()=>({draw:new h.Howl({src:["/sounds/draw.mp3","/sounds/draw.wav"],volume:.3,html5:!0,onloaderror:()=>{}}),discard:new h.Howl({src:["/sounds/discard.mp3","/sounds/discard.wav"],volume:.4,html5:!0,onloaderror:()=>{}}),win:new h.Howl({src:["/sounds/win.mp3","/sounds/win.wav"],volume:.5,html5:!0,onloaderror:()=>{}}),button:new h.Howl({src:["/sounds/button.mp3","/sounds/button.wav"],volume:.2,html5:!0,onloaderror:()=>{}}),shuffle:new h.Howl({src:["/sounds/shuffle.mp3","/sounds/shuffle.wav"],volume:.3,html5:!0,onloaderror:()=>{}})}),[]),o=d.useCallback(async e=>{try{switch(e){case"draw":await t(800,.2,"sine");break;case"discard":await t(400,.3,"sawtooth");break;case"shuffle":setTimeout(async()=>await t(300,.1,"square"),0),setTimeout(async()=>await t(350,.1,"square"),100),setTimeout(async()=>await t(320,.1,"square"),200);break;case"win":await t(523,.4,"sine"),setTimeout(async()=>await t(659,.4,"sine"),200),setTimeout(async()=>await t(784,.6,"sine"),400);break;case"button":await t(1e3,.1,"square")}}catch(a){}},[t]);return{playSound:d.useCallback(async a=>{if(e)try{const e=r[a];if("loaded"===e.state())try{e.play()}catch(s){await o(a)}else await o(a)}catch(x){}},[e,r,o]),soundsEnabled:e,toggleSounds:()=>a(!e)}})(),N=d.useMemo(()=>({createLobby:async(e,a)=>{const s=await fetch(`${F}/lobby/create`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:e,max_players:a})});if(!s.ok)throw new Error("Failed to create lobby");return await s.json()},joinLobby:async(e,a)=>{const s=await fetch(`${F}/lobby/${e}/join`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({player:a})});if(!s.ok)throw new Error("Failed to join lobby");return await s.json()},getLobbies:async()=>{const e=await fetch(`${F}/lobbies`);if(!e.ok)throw new Error("Failed to fetch lobbies");return await e.json()},getGame:async e=>{const a=await fetch(`${F}/game/${e}`);if(!a.ok)throw new Error("Failed to fetch game state");return await a.json()},drawCard:async e=>{const a=await fetch(`${F}/game/${e}/draw`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error("Failed to draw card");return await a.json()},discardCard:async(e,a)=>{const s=await fetch(`${F}/game/${e}/discard?card_index=${a}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error("Failed to discard card");return await s.json()},createNewGame:async(e,a,s=1,n=4)=>{const t=await fetch(`${F}/new_game?mode=${e}&player_name=${encodeURIComponent(a)}&cpu_count=${s}&max_players=${n}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("Failed to create game");return await t.json()},joinGame:async(e,a)=>{const s=await fetch(`${F}/join_game?game_id=${e}&player_name=${encodeURIComponent(a)}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error("Failed to join game");return await s.json()},cancelLobby:async(e,a)=>{if(!(await fetch(`${F}/lobby/cancel?lobby_id=${e}&host_name=${encodeURIComponent(a)}`,{method:"POST"})).ok)throw new Error("Failed to cancel lobby")}}),[]),C=d.useCallback(async()=>{try{const e=await N.getLobbies();u(e)}catch(e){b(e.message||"Failed to fetch lobbies")}},[N]);d.useEffect(()=>{if("multiplayer"===e){C();const e=setInterval(C,1e4);return()=>clearInterval(e)}},[e,C]);const S=()=>{a("home")},P=()=>{j(null),y(null),a("home")};return c.jsxs("div",{className:"App",children:[c.jsx("h1",{children:"Njuka King"}),c.jsx(R,{isOpen:!!x,onClose:()=>b(null),message:x||"",showRetryButton:x?.includes("Connection")||x?.includes("Network")||!1,onRetry:()=>window.location.reload(),retryButtonText:"Retry Connection"}),c.jsx(L,{isVisible:w.starting||w.joining,message:"Connecting to game server..."}),p?c.jsxs("div",{className:"game-container",children:[c.jsx($,{state:p,playerName:s,onDiscard:async e=>{g(e=>({...e,discarding:!0})),b(null);try{if(!p)return;const a=await N.discardCard(p.id,e);j(a),v("discard")}catch(a){b(a.message||"Failed to discard card")}finally{g(e=>({...e,discarding:!1}))}},onDraw:async()=>{g(e=>({...e,drawing:!0})),b(null);try{if(!p)return;const e=await N.drawCard(p.id);j(e),v("draw")}catch(e){b(e.message||"Failed to draw card")}finally{g(e=>({...e,drawing:!1}))}},loadingStates:w,playSound:v,showTutorial:"tutorial"===e,onCloseTutorial:S}),c.jsx(M,{isOpen:!!p.game_over,onClose:P,winner:p.winner||"Unknown",winnerHand:p.winner_hand,onNewGame:P})]}):m?c.jsxs("div",{className:"lobby-view",children:[c.jsxs("h2",{children:["Lobby: ",m.id]}),c.jsxs("p",{children:["Host: ",m.host]}),c.jsxs("p",{children:["Players: ",m.players.length,"/",m.max_players]}),c.jsxs("div",{className:"player-list",children:[c.jsx("h3",{children:"Players:"}),c.jsx("ul",{children:m.players.map(e=>c.jsxs("li",{children:[e," ",e===s&&"(You)",e===m.host&&" ðŸ‘‘"]},e))})]}),c.jsxs("div",{className:"lobby-actions",children:[m.host===s&&!m.started&&c.jsx("button",{onClick:async()=>{if(m){g(e=>({...e,starting:!0}));try{await N.cancelLobby(m.id,s),y(null),a("home"),v("button")}catch(e){b(e.message||"Failed to cancel lobby")}finally{g(e=>({...e,starting:!1}))}}},className:"cancel-btn",disabled:w.starting,children:w.starting?"Cancelling...":"Cancel Game"}),c.jsx("button",{onClick:()=>y(null),className:"quit-btn",children:"Leave Lobby"})]})]}):c.jsxs(c.Fragment,{children:["home"===e&&c.jsx(z,{onSelectMode:e=>{a("multiplayer"===e?"multiplayer":"cpu")},playerName:s,setPlayerName:n}),"multiplayer"===e&&c.jsx(B,{onBack:()=>a("home"),playerName:s,numPlayers:t,setNumPlayers:r,onCreateLobby:async()=>{g(e=>({...e,starting:!0}));try{const e=await N.createLobby(s,t);y(e),v("button")}catch(e){b(e.message||"Failed to create game")}finally{g(e=>({...e,starting:!1}))}},onJoinLobby:async e=>{g(e=>({...e,joining:!0}));try{const a=await N.joinLobby(e,s);y(a),v("button")}catch(a){b(a.message||"Failed to join game")}finally{g(e=>({...e,joining:!1}))}},lobbies:l,loadingStates:w,onRefreshLobbies:C}),"cpu"===e&&c.jsx(G,{onBack:()=>a("home"),onStartGame:async()=>{g(e=>({...e,starting:!0}));try{const e=await N.createNewGame("cpu",s,o);j(e),a("game"),v("shuffle")}catch(e){b(e.message||"Failed to create game")}finally{g(e=>({...e,starting:!1}))}},numCPU:o,setNumCPU:i,loadingStates:w}),"rules"===e&&c.jsx(H,{onBack:()=>a("home")}),"tutorial"===e&&c.jsx(_,{isOpen:!0,onClose:S})]}),c.jsx(q,{quitGameToMenu:p?P:void 0,soundsEnabled:f,toggleSounds:k,playSound:v,onShowRules:()=>{a("rules")},onGoHome:()=>{a("home"),y(null),j(null)}})]})}export{U as A,A as M,u as R,c as j,d as r};
